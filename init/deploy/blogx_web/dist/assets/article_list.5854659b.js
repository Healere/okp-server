import{v as D,d as M,a as F,b as j,k as z,r as _,o as i,e as p,f as u,w as a,i as I,c as b,h as l,F as H,g as T,j as V,M as d,m as B,n as G,u as w,t as v,p as J}from"./index.b57f2f57.js";import{u as K}from"./user_base_store.744befab.js";import{F as N}from"./f_a.a86d598e.js";import{_ as O}from"./f_article_list.vue_vue_type_style_index_0_lang.cee58350.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./article_api.d25b0d15.js";import"./go_router.d8eedbce.js";import"./date.5a421098.js";function P(n){return D.get("/api/category",{params:n})}function Q(n){return D.post("/api/category",n)}function W(n){return D.delete("/api/category",{data:{idList:n}})}const X={class:"f_category_list_com"},Y={key:0,class:"add"},Z={class:"list"},ee=["onClick"],te=["onClick"],se=M({__name:"f_category_list",props:{userId:{},isMe:{type:Boolean}},setup(n){const c=V(),r=n,m=F({list:[],count:0}),C=F({userID:r.userId,type:2});async function g(){const e=await P(C);if(e.code){d.error(e.msg);return}m.list=e.data.list,m.count=e.data.count}const o=F({id:0,title:""}),y=j(!1);function $(){o.id=0,o.title="",y.value=!0}function A(e){o.id=e.id,o.title=e.title,y.value=!0}async function q(){if(o.title.trim()===""){d.warning("\u8BF7\u8F93\u5165\u5206\u7C7B\u540D\u79F0");return}let e;if(e=await Q(o),e.code){d.error(e.msg);return}d.success(e.msg),g()}async function E(e){const s=await W([e.id]);if(s.code){d.error(s.msg);return}d.success(s.msg),g()}function h(e){const s=Number(c.query.categoryID);let f=e.id;s===e.id&&(f=void 0),J.push({name:c.name,query:{...c.query,categoryID:f},params:c.params})}return z(()=>r.userId,()=>{const e=Number(r.userId);isNaN(e)||(C.userID=e,g())}),g(),(e,s)=>{const f=_("icon-plus"),S=_("a-button"),L=_("a-input"),R=_("a-modal"),x=_("a-typography-text"),U=_("a-trigger");return i(),p("div",X,[r.isMe?(i(),p("div",Y,[u(S,{long:"",type:"outline",onClick:$},{icon:a(()=>[u(f)]),default:a(()=>[s[2]||(s[2]=B(" \u521B\u5EFA "))]),_:1})])):I("",!0),r.isMe?(i(),b(R,{key:1,width:"30%",title:o.id?"\u7F16\u8F91\u5206\u7C7B":"\u521B\u5EFA\u5206\u7C7B",visible:y.value,"onUpdate:visible":s[1]||(s[1]=t=>y.value=t),"on-before-ok":q},{default:a(()=>[u(L,{placeholder:"\u5206\u7C7B\u540D\u79F0",modelValue:o.title,"onUpdate:modelValue":s[0]||(s[0]=t=>o.title=t)},null,8,["modelValue"])]),_:1},8,["title","visible"])):I("",!0),l("div",Z,[(i(!0),p(H,null,T(m.list,t=>(i(),p("div",{class:G(["item",{active:t.id===Number(w(c).query.categoryID)}])},[r.isMe?(i(),b(U,{key:0,"content-class":"category_trigger",trigger:"contextMenu","align-point":""},{content:a(()=>[l("div",{class:"item",onClick:k=>A(t)},"\u7F16\u8F91",8,ee),l("div",{class:"item delete",onClick:k=>E(t)},"\u5220\u9664",8,te)]),default:a(()=>[u(N,{onClick:k=>h(t)},{default:a(()=>[l("span",null,[u(x,{ellipsis:{css:!0,rows:1}},{default:a(()=>[B(v(t.title),1)]),_:2},1024)]),l("span",null,v(t.articleCount),1)]),_:2},1032,["onClick"])]),_:2},1024)):(i(),b(N,{key:1,onClick:k=>h(t)},{default:a(()=>[l("span",null,[u(x,{ellipsis:{css:!0,rows:1}},{default:a(()=>[B(v(t.title),1)]),_:2},1024)]),l("span",null,v(t.articleCount),1)]),_:2},1032,["onClick"]))],2))),256))])])}}});const oe={class:"user_article_list_view"},de=M({__name:"article_list",setup(n){const c=K(),r=V();return(m,C)=>(i(),p("div",oe,[u(se,{"user-id":Number(w(r).params.id),"is-me":w(c).isMe},null,8,["user-id","is-me"]),u(O)]))}});export{de as default};
