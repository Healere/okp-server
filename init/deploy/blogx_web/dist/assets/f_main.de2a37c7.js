import{d as w,r as d,o as r,c as F,w as a,y as z,q as L,u as o,f as s,m as g,h as t,p as H,s as O,t as A,e as x,i as E,v as R,a as S,b as h,z as U,l as N,g as j,F as K,M as T,A as J,n as q}from"./index.b57f2f57.js";import{g as G}from"./go_router.d8eedbce.js";import{_ as P}from"./f_theme.vue_vue_type_script_setup_true_lang.c42e8a1a.js";import{_ as Q}from"./_plugin-vue_export-helper.cdc0426e.js";const M=w({__name:"f_point",props:{count:{}},setup(f){const n=f;return(c,i)=>{const e=d("a-badge");return r(),F(e,{class:"f_point_com",count:n.count,dot:"",dotStyle:{width:"5px",height:"5px"}},{default:a(()=>[z(c.$slots,"default")]),_:3},8,["count"])}}});const W=w({__name:"f_nav_msg",setup(f){const n=L();function c(i){const e=i;H.push({name:e})}return n.isLogin&&n.unReadMsg(),(i,e)=>{const m=d("a-doption"),p=d("a-dropdown");return r(),F(M,{count:o(n).unReadMsgAll,class:"f_nav_msg_com"},{default:a(()=>[s(p,{class:"f_nav_msg_dropdown",onSelect:c},{content:a(()=>[s(m,{value:"msgComment"},{default:a(()=>[s(M,{count:o(n).unMsgInfo.commentMsgCount},{default:a(()=>e[0]||(e[0]=[g("\u8BC4\u8BBA\u548C@")])),_:1},8,["count"])]),_:1}),s(m,{value:"msgDigg"},{default:a(()=>[s(M,{count:o(n).unMsgInfo.diggMsgCount},{default:a(()=>e[1]||(e[1]=[g("\u8D5E\u548C\u6536\u85CF")])),_:1},8,["count"])]),_:1}),s(m,{value:"msgChat"},{default:a(()=>[s(M,{count:o(n).unMsgInfo.privateMsgCount},{default:a(()=>e[2]||(e[2]=[g("\u7528\u6237\u79C1\u4FE1")])),_:1},8,["count"])]),_:1}),s(m,{value:"msgSystem"},{default:a(()=>[s(M,{count:o(n).unMsgInfo.systemMsgCount},{default:a(()=>e[3]||(e[3]=[g("\u7CFB\u7EDF\u901A\u77E5")])),_:1},8,["count"])]),_:1})]),default:a(()=>[e[4]||(e[4]=t("a",{href:"javascript:void 0"},"\u6D88\u606F",-1))]),_:1})]),_:1},8,["count"])}}});const X={class:"f_nav_avatar_com"},Y={class:"avatar"},Z={class:"nickname"},ee={class:"data"},te={class:"menu"},ne={class:"item"},se={class:"exit"},oe=w({__name:"f_nav_avatar",setup(f){const n=L();function c(i){if(i==="exit"){n.userLogout();return}H.push({name:i})}return(i,e)=>{const m=d("a-avatar"),p=d("a-typography-text"),v=d("a-statistic"),C=d("router-link"),y=d("a-trigger");return o(n).isLogin?(r(),F(y,{key:1,class:"f_nav_avatar_trigger","animation-name":"fade",trigger:"hover","unmount-on-close":!1},{content:a(()=>[t("div",X,[t("div",Y,[s(m,{onClick:e[1]||(e[1]=k=>o(G)(o(n).userInfo.userID)),"image-url":o(n).userInfo.avatar,size:60},{default:a(()=>[g(A(o(n).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),t("div",Z,[s(p,{ellipsis:{rows:1,css:!0}},{default:a(()=>[g(A(o(n).userInfo.nickName),1)]),_:1})]),t("div",ee,[s(C,{to:{name:"userFansList",params:{id:o(n).userInfo.userID}}},{default:a(()=>[s(v,{extra:"\u7C89\u4E1D",value:o(n).userInfo.fansCount},null,8,["value"])]),_:1},8,["to"]),s(C,{to:{name:"userFocusList",params:{id:o(n).userInfo.userID}}},{default:a(()=>[s(v,{extra:"\u5173\u6CE8",value:o(n).userInfo.followCount},null,8,["value"])]),_:1},8,["to"]),s(C,{to:{name:"userArticle",params:{id:o(n).userInfo.userID}}},{default:a(()=>[s(v,{extra:"\u6587\u7AE0",value:o(n).userInfo.articleCount},null,8,["value"])]),_:1},8,["to"])]),t("div",te,[t("div",{class:"item",onClick:e[2]||(e[2]=k=>c("userCenterInfo"))},e[8]||(e[8]=[t("i",{class:"iconfont icon-list"},null,-1),g(),t("span",null,"\u4E2A\u4EBA\u4E2D\u5FC3",-1)])),t("div",{class:"item",onClick:e[3]||(e[3]=k=>c("platformArticle"))},e[9]||(e[9]=[t("i",{class:"iconfont icon-wenzhangguanli"},null,-1),t("span",null,"\u6587\u7AE0\u7BA1\u7406",-1)])),t("div",{class:"item",onClick:e[4]||(e[4]=k=>c("msgChat"))},e[10]||(e[10]=[t("i",{class:"iconfont icon-xiaoxi"},null,-1),g(),t("span",null,"\u6211\u7684\u6D88\u606F",-1)])),o(n).isAdmin?(r(),x("div",{key:0,class:"item",onClick:e[5]||(e[5]=k=>c("home"))},e[11]||(e[11]=[t("i",{class:"iconfont icon-list"},null,-1),g(),t("span",null,"\u540E\u53F0\u7BA1\u7406",-1)]))):E("",!0),t("div",ne,[s(P)])]),t("div",se,[t("div",{class:"item",onClick:e[6]||(e[6]=k=>c("exit"))},e[12]||(e[12]=[t("i",{class:"iconfont icon-liulanliang"},null,-1),g(),t("span",null,"\u9000\u51FA",-1)]))])])]),default:a(()=>[s(m,{class:"avatar_1","image-url":o(n).userInfo.avatar,size:30},{default:a(()=>[g(A(o(n).userInfo.nickName[0]),1)]),_:1},8,["image-url"])]),_:1})):(r(),F(m,{key:0,class:"avatar_1",size:30,onClick:e[0]||(e[0]=k=>o(O)({}))},{default:a(()=>e[7]||(e[7]=[g("\u767B\u5F55")])),_:1}))}}});function Te(f){return R.get("/api/search/article",{params:f})}function Re(f){return R.get("/api/search/tags",{params:f})}function ae(f){return R.get("/api/search/text",{params:f})}const ue={class:"head"},le={class:"body"},ie={class:"list scrollbar"},re=["onClick"],ce=["innerHTML"],_e=["innerHTML"],de={key:0,class:"page"},fe=w({__name:"f_text_search_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{expose:n,emit:c}){const i=f,e=c;function m(){p.key="",v.list=[],v.count=0,e("update:visible",!1)}const p=S({key:""}),v=S({list:[],count:0}),C=h(!1);async function y(){C.value=!1;const u=await ae(p);if(u.code){T.error(u.msg);return}Object.assign(v,u.data),C.value=!0}function k(u){p.key=u,y()}const $=h();function l(){p.key===""&&U(()=>{$.value.focus()})}function _(u){window.open(`/article/${u.articleID}?id=${u.flag}`,"_blank")}return n({setSearch:k}),(u,b)=>{const I=d("a-input"),V=d("a-button"),B=d("a-modal");return r(),F(B,{title:"\u5168\u6587\u641C\u7D22",onBeforeOpen:l,footer:!1,"body-class":"f_article_search_modal_body",visible:i.visible,onCancel:m},{default:a(()=>[t("div",ue,[s(I,{ref_key:"textRef",ref:$,modelValue:p.key,"onUpdate:modelValue":b[0]||(b[0]=D=>p.key=D),onKeydown:N(y,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u641C\u7D22\u5185\u5BB9"},null,8,["modelValue"]),s(V,{onClick:y,type:"primary"},{default:a(()=>b[1]||(b[1]=[g("\u641C\u7D22")])),_:1})]),t("div",le,[t("div",ie,[(r(!0),x(K,null,j(v.list,D=>(r(),x("div",{class:"item",onClick:Me=>_(D)},[t("div",{class:"title",innerHTML:D.head},null,8,ce),t("div",{class:"abs",innerHTML:D.body},null,8,_e)],8,re))),256))]),C.value?(r(),x("div",de," \u5171\u641C\u7D22\u5230\u7ED3\u679C"+A(v.list.length)+"\u6761 ",1)):E("",!0)])]),_:1},8,["visible"])}}});const ve={class:"body scrollbar"},me=["innerHTML"],pe={key:1,class:"chat"},ge={class:"menu"},ye={class:"info"},ke=w({__name:"f_ai_modal",props:{visible:{type:Boolean}},emits:["update:visible"],setup(f,{emit:n}){const c=L(),i=h([]),e=f,m=n;function p(){i.value=[],m("update:visible",!1)}async function v(){if(!c.isLogin){T.warning("\u8BF7\u767B\u5F55"),O();return}i.value.push({isMe:!0,nickname:c.userInfo.nickName,avatar:c.userInfo.avatar,content:$.value});const l=S({isMe:!1,nickname:y.nickname,avatar:y.avatar,content:""}),_=new EventSource(`/api/ai/article?content=${$.value}&token=${c.userInfo.token}`);_.onmessage=u=>{const b=JSON.parse(u.data);l.content+=b.data,console.log(b)},_.onerror=u=>{console.log(u),_.close()},_.addEventListener("close",function(u){console.log(u)}),i.value.push(l),$.value=""}const C=h(),y=S({isMe:!1,nickname:"",avatar:"",content:""});async function k(){i.value=[],y.content="";const l=await J();if(l.code){T.error(l.msg);return}Object.assign(y,l.data),i.value.push(y);const _=l.data.abstract.split("");for(let u=0;u<_.length;u++)setTimeout(()=>{y.content+=_[u]},40*u);U(()=>{C.value.focus()})}const $=h("");return(l,_)=>{const u=d("a-avatar"),b=d("a-textarea"),I=d("a-button"),V=d("a-modal");return r(),F(V,{onBeforeOpen:k,footer:!1,"modal-class":"f_ai_modal",visible:e.visible,onCancel:p},{default:a(()=>[t("div",ve,[(r(!0),x(K,null,j(i.value,B=>(r(),x("div",{class:q(["item",{isMe:B.isMe}])},[s(u,{"image-url":B.avatar},null,8,["image-url"]),B.isMe?(r(),x("div",pe,A(B.content),1)):(r(),x("div",{key:0,class:"chat",innerHTML:B.content},null,8,me))],2))),256))]),t("div",ge,[s(b,{ref_key:"textareaRef",ref:C,"auto-size":{minRows:4,maxRows:4},modelValue:$.value,"onUpdate:modelValue":_[0]||(_[0]=B=>$.value=B),onKeydown:N(v,["enter"]),placeholder:"\u8BF7\u8F93\u5165\u4F60\u611F\u5174\u8DA3\u7684\u5185\u5BB9"},null,8,["modelValue"]),t("div",ye,[_[2]||(_[2]=t("span",null,"\u6309Enter\u53D1\u9001\uFF0C\u6309Ctrl+Enter\u6362\u884C",-1)),s(I,{onClick:v,type:"primary"},{default:a(()=>_[1]||(_[1]=[g("\u53D1\u9001")])),_:1})])])]),_:1},8,["visible"])}}});const Ce={class:"container"},be={class:"logo"},xe={href:"/"},$e={class:"n1"},Ie={class:"n2"},he={class:"center"},Be={class:"right"},Ne=w({__name:"f_nav",props:{noScroll:{type:Boolean},scrollTop:{}},setup(f){const n=L(),c=f,{noScroll:i=!1,scrollTop:e=200}=c,m=h(i);i||(window.onscroll=function(){document.documentElement.scrollTop>=e?m.value=!0:m.value=!1});const p=h(!1),v=h(""),C=h();function y(){p.value=!0,v.value&&C.value.setSearch(v.value)}const k=h(!1);return($,l)=>{const _=d("a-input-search"),u=d("router-link"),b=d("a-button");return r(),x("div",{class:q(["f_nav",{isShow:m.value}])},[t("div",Ce,[t("div",be,[t("a",xe,[t("span",$e,A(o(n).siteInfo.siteInfo.slogan?o(n).siteInfo.siteInfo.slogan:"Blogx"),1),t("span",Ie,A(o(n).siteInfo.siteInfo.mode===1?"\u793E\u533A\u7248":"\u535A\u5BA2\u7248"),1)])]),o(n).siteInfo.ai.enable?(r(),F(ke,{key:0,visible:k.value,"onUpdate:visible":l[0]||(l[0]=I=>k.value=I)},null,8,["visible"])):E("",!0),s(fe,{ref_key:"textSearchRef",ref:C,visible:p.value,"onUpdate:visible":l[1]||(l[1]=I=>p.value=I)},null,8,["visible"]),t("div",he,[o(n).siteInfo.ai.enable?(r(),x("i",{key:0,onClick:l[2]||(l[2]=I=>k.value=!0),class:"iconfont icon-dengpao"})):E("",!0),s(_,{modelValue:v.value,"onUpdate:modelValue":l[3]||(l[3]=I=>v.value=I),onSearch:y,onKeydown:N(y,["enter"]),placeholder:"\u641C\u7D22\u4F60\u559C\u6B22\u7684\u6587\u7AE0"},null,8,["modelValue"])]),t("div",Be,[s(oe),s(W),s(u,{class:"history",to:{name:"userCenterHistory"}},{default:a(()=>l[4]||(l[4]=[g("\u5386\u53F2")])),_:1}),o(n).siteInfo.siteInfo.mode===2&&!o(n).isAdmin?E("",!0):(r(),F(u,{key:0,to:{name:"platformArticleAdd"}},{default:a(()=>[s(b,{type:"primary"},{default:a(()=>l[5]||(l[5]=[t("i",{class:"iconfont icon-jia"},null,-1),g(),t("span",null,"\u53D1\u5E03",-1)])),_:1})]),_:1}))])])],2)}}});const Fe={},Ae={class:"f_main_com"},we={class:"f_container"};function De(f,n){return r(),x("div",Ae,[t("div",we,[z(f.$slots,"default")])])}const ze=Q(Fe,[["render",De]]);export{ze as F,Ne as _,Te as a,Re as t};
